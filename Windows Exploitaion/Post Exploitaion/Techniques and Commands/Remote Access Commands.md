# Windows Remote Access Commands

Commands that move data and files between systems on a network and are usually executed from the context of the `cmd.exe` or `command.exe` prompt.

## Miscellaneous
### dir
 * **Command with arguments**: `dir \\[computername|ip]\share`
 * **Description**: **Must have token to the remote system.** See `net use` below to establish such a connection. Displays the contents of the remote computer's share.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>dir \\192.168.10.34\c$
 Volume in drive \\192.168.10.34\c$ has no label.
 Volume Serial Number is 1A09-5F16<br>
 Directory of \\192.168.10.34\c$<br>
09/18/2006  05:43 PM                24 autoexec.bat
09/18/2006  05:43 PM                10 config.sys
01/19/2008  05:40 AM    <DIR>          PerfLogs
10/08/2013  07:36 PM    <DIR>          Program Files
10/23/2013  08:20 PM    <DIR>          temp
10/10/2013  08:59 PM    <DIR>          Users
10/23/2013  08:38 PM    <DIR>          Windows
               2 File(s)             34 bytes
               5 Dir(s)  33,316,192,256 bytes free</code></div> 
      
### qprocess
 * **Command with arguments**: `qprocess * [/SERVER:computername]`
 * **Description**: Shows information about processes locally or remotely if you provide the computername or IP.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>qprocess * /SERVER:192.168.1.2
 USERNAME              SESSIONNAME         ID    PID  IMAGE
 (unknown)             services             0      0
 (unknown)             services             0      4  system
 (unknown)             services             0    268  smss.exe
 (unknown)             services             0    356  csrss.exe
 (unknown)             services             0    408  wininit.exe
>(unknown)             console              1    420  csrss.exe
>(unknown)             console              1    460  winlogon.exe
 (unknown)             services             0    516  services.exe
>johndoe               console              1   1584  dwm.exe
>johndoe               console              1   1600  explorer.exe
 (unknown)             services             0   1708  vmtoolsd.exe
>johndoe               console              1   1936  vmwaretray.exe
>johndoe               console              1   1944  vmtoolsd.exe
 (unknown)             services             0    316  tpautoconnsv...
>johndoe               console              1   1716  tpautoconnec...
>johndoe               console              1   1680  conhost.exe
 (unknown)             services             0   1984  searchindexe...
 (unknown)             services             0   2076  msdtc.exe
 (unknown)             services             0   2844  svchost.exe
 (unknown)             services             0   2920  sppsvc.exe
 (unknown)             services             0   2976  svchost.exe
>johndoe               console              1   3576  cmd.exe
>johndoe               console              1   3540  conhost.exe
>johndoe               console              1   2340  cmd.exe
>johndoe               console              1   1560  conhost.exe
>johndoe               console              1   3616  qprocess.exe</code></div> 
   
### qwinsta
 * **Command with arguments**: `qwinsta [/SERVER:computername]`
 * **Description**: Shows information about Remote Desktop Sessions locally or remotely if you provide the computername or IP.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>qwinsta<br> SESSIONNAME       USERNAME                 ID  STATE   TYPE        DEVICE<br> services                                    0  Disc<br>>console           johndoe                   1  Active<br> rdp-tcp                                 65536  Listen</code></div> 

### Remote Assistance Enable
 * **Command with arguments**: `reg add “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server” /v fAllowToGetHelp /t REG_DWORD /d 1 /f`
 * **Description**: **Must be admin to run this.** Enable remote assistance through adding a registry entry on the local system.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Windows\system32>reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
The operation completed successfully.</code></div> 

### Remote Desktop Enable
 * **Command with arguments**: `reg add “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server” /v fDenyTSConnections /t REG_DWORD /d 0 /f`
 * **Description**: **Must be admin to run this.** Enable remote desktop through adding a registry entry on the local system.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Windows\system32>reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
The operation completed successfully.</code></div> 

### tasklist
 * **Command with arguments**: `tasklist /v /s [computername|IP]`
 * **Description**: Retrieve the current running processes from the remote system. [Microsoft manual](http://technet.microsoft.com/en-us/library/bb491010.aspx).
