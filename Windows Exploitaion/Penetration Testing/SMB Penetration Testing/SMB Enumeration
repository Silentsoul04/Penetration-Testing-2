## SMB Enumeration

enum4linux -S 192.168.10.1

### smbmap

smbmap -H 192.168.10.1
smbmap -R [shared dir] -H 192.168.10.1 = list contents
smbmap -R [shared dir] -H 192.168.10.1 -A [filename.xml] -q = download content 

smbmap -d active.htb -u [USER NAME] -p [PASSWORD] -H 192.168.10.1
smbmap -d active.htb -u [USER NAME] -p [PASSWORD] -H 192.168.10.1 -R [Users] = download all contents in a filename Users

### smbclient ( -L list shares, -N anonymous logon,)

smbclient -L //192.168.10.1
smbclient -L //10.10.10.100 -N

download all contents in a filename folder[ ! password required]
smbclient //192.168.10.1/filename
>recurse ON
>prompt OFF
>mget *

### NBTSCAN

nbtscan -r 10.0.2.0/24


### NMAP
nmap --script smb-enum-services -p 445 192.168.10.1 -d
nmap -p 445 -A 192.168.1.101
nmap -p 1-65535 -T4 -O -A -v 10.0.2.15


SMB Enumeration Techniques using Windows Tools:

1. NetBIOS Enumerator (nbtenum)

http://nbtenum.sourceforge.net/
------------------------------------------------------------

SMB\RPC Enumeration (139/445):

    enum4linux â€“a 10.0.0.1
    nbtscan x.x.x.x // Discover Windows / Samba servers on subnet, finds Windows MAC addresses, netbios name and discover client workgroup / domain
    py 192.168.XXX.XXX 500 50000 dict.txt
    python /usr/share/doc/python-impacket-doc/examples/samrdump.py 192.168.XXX.XXX
    nmap IPADDR --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse
    smbclient -L INSERTIPADDRESS
    smbclient //INSERTIPADDRESS/tmp
    smbclient INSERTIPADDRESS ipc$ -U john
    
_____________________________________________________________________________________________________________________________________
### Other links
https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/

https://www.hackingarticles.in/5-ways-to-hack-smb-login-password/

https://www.hackingarticles.in/3-ways-scan-eternal-blue-vulnerability-remote-pc/

https://www.hackingarticles.in/smb-penetration-testing-port-445/

https://www.hackingarticles.in/netbios-and-smb-penetration-testing-on-windows/

https://medium.com/@arnavtripathy98/smb-enumeration-for-penetration-testing-e782a328bf1b
